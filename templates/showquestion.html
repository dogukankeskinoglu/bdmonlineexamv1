<!DOCTYPE HTML>
<html>

<head>
    <meta charset="UTF-8">
    <title>Questions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/main.css')}}" />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous">
    </script>

    <style>
        .soruicerik {
            background-color: white;
        }
    </style>
</head>

<body>
    <div id="examContent" class="content">
        <h1>{{exam_id}}</h1>
        {% for i in sorular %} {% set outer_loop = loop.index-1 %} {% set question_no=loop.index %}
        <div class="soruicerik">
            <form action="">
                <blockquote style="font-style: normal;">Soru {{question_no}}</blockquote>
                <p>{{i[2]}}</p>
                {% for k in i[3].split("*_*") %} {% set question_var = ['question', question_no, 'choice', loop.index]|join('_') %}
                <input type="radio" id={{question_var}} name={{question_no}}>
                <label for={{question_var}}></label>
                <label id=" questionlabel " +{{question_var}}>{{k}} </label>
                <p>{{question_var}}</p>
                {% endfor %}
            </form>
            <h3>Soru puanı:{{i[5]}}</h3>
        </div>
        {% endfor %}
        <button type="button" onclick="finishExam()">Finish Exam</button>
        <button type="button" onclick="showExamSize()">Show Exam Size</button>
    </div>
    <script>
        var exam_length = '{{sorusayisi}}'
        var exam_questions = []
        var dogru_cevap_sık = "z";
        var soru_key = "";


        function showExamSize() {
            alert(exam_length)
        }

        function finishExam() {
            for (var i = 0; i < exam_length; i++) {
                //alert("index" + (i + 1))
                soru_key = "question" + (i + 1);
                alert("soru key" + soru_key)
                for (var k = 1; k < 6; k++) {
                    if (document.getElementById("question_" + (i + 1) + "_choice_" + k).checked) {
                        switch (k) {
                            case 1:
                                dogru_cevap_sık = "a";
                                break;
                            case 2:
                                dogru_cevap_sık = "b";
                                break;
                            case 3:
                                dogru_cevap_sık = "c";
                                break;
                            case 4:
                                dogru_cevap_sık = "d";
                                break;
                            case 5:
                                dogru_cevap_sık = "e";
                                break;
                        }
                    }
                }
                alert("dogru cevap" + dogru_cevap_sık)
                exam_questions.push({
                    key: soru_key,
                    value: dogru_cevap_sık
                })
                for (var k in exam_questions) {
                    alert(exam_questions[k])
                }
                /*$.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    url: "{{url_for('exam_result')}}",
                    type: 'POST',
                    data: JSON.stringify({
                        'data': exam_questions
                    }),
                    success: function(response) {
                        alert("İşlem başarılı!");
                        window.location.href = "/exam/examresult";
                    },
                    error: function(error) {
                        alert("error");
                    }
                });*/
            }
        }
    </script>

</body>

</html>